# 微博监控系统 - WeiboMonitor

## 项目简介

本项目是一个微博监控与分析系统，用于监控微博，自动收集用户反馈并生成可视化问题清单报告。系统采用智能分析技术，能够识别、分类和优先级排序用户反馈中的问题，为产品改进提供数据支持。

## 核心功能

### 🔍 智能监控
- **自动抓取**: 使用Selenium自动化技术抓取指定微博账号的评论数据
- **实时截图**: 对重要反馈页面进行截图保存，确保数据完整性
- **去重过滤**: 智能识别并过滤重复评论和无效信息

### 🧠 智能分析
- **问题识别**: 基于关键词和语义分析识别用户反馈中的问题
- **自动分类**: 将问题按硬件、软件、UI、功能等维度进行分类
- **严重程度评估**: 根据关键词、用户互动等因素评估问题严重程度
- **频率统计**: 统计相似问题出现频率，识别高频问题

### 📊 可视化报告
- **现代化界面**: 采用小米品牌风格的响应式设计
- **数据图表**: 使用Chart.js展示问题分布、趋势等数据
- **交互功能**: 支持筛选、搜索、截图查看等交互操作
- **移动适配**: 输出报告格式为html文件

## 技术架构

### 后端技术栈
- **Python 3.8+**: 主要开发语言
- **Selenium**: 网页自动化抓取
- **jieba**: 中文分词与文本分析
- **BeautifulSoup**: HTML解析
- **Requests**: HTTP请求处理

### 前端技术栈
- **HTML5 + CSS3**: 基础页面结构
- **JavaScript (ES6+)**: 交互逻辑实现
- **Chart.js**: 数据可视化图表
- **Tailwind CSS**: 响应式样式框架

## 安装与配置

### 环境要求
- Python 3.8 或更高版本
- Chrome 浏览器（最新版本）
- 稳定的网络连接

### 安装步骤

1. **克隆项目**
```bash
git clone https://github.com/henrypuppy/WeiboMonitor.git
cd WeiboMonitor
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **Chrome驱动配置**
系统会自动下载并配置Chrome WebDriver，无需手动安装。

4. **配置监控目标**
编辑 `config.py` 中的目标用户信息和微博链接。

## 使用方法

### 快速开始

1. **运行监控脚本**
```bash
python weibo_scraper.py
```

2. **查看报告**
脚本运行完成后，会生成带时间戳的HTML报告文件，使用浏览器打开即可查看（密码是xiaomi2025，可以在模版文件中修改）。

### 自定义配置

#### 修改监控目标
```python
# 在config.py中修改
monitor = WeiboMonitor(target_user="目标用户名")

weibo_urls = [
    "https://weibo.com/u/用户ID",
    # 添加更多链接
]
```


### 定时任务设置
#### Windows任务计划程序
1. 打开"任务计划程序"
2. 创建基本任务
3. 设置触发器为"每天"
4. 操作选择"启动程序"，程序路径指向Python.exe，参数为脚本路径


## 报告功能说明

### 报告结构
- **概览统计**: 评论总数、问题总数、严重程度分布
- **可视化图表**: 饼图、柱状图、趋势图
- **问题详情**: 按优先级排序的问题列表
- **改进建议**: 基于问题分析的改进建议，支持调用大语言模型API接口
- **原始数据**: 数据保存在data文件下，评论和问题分析

### 安全特性
- **访问控制**: 报告页面密码保护
- **本地存储**: 数据保存在本地，确保隐私安全

## 项目结构

```
WeiboMonitor/
├── weibo_scraper.py          # 主要爬虫和分析脚本
├── complete_report.html      # 完整报告模板
├── requirements.txt          # Python依赖包
├── README.md                # 项目说明文档
├── reports/                 # 生成报告保存目录
└── data/                    # 原始数据保存目录
```

## 常见问题

### Q: Chrome驱动版本不匹配怎么办？
A: 系统使用webdriver-manager自动管理驱动版本，通常不会出现版本问题。如遇问题，请更新Chrome浏览器到最新版本。

### Q: 抓取数据为空怎么办？
A: 检查网络连接和微博链接是否正确，部分页面可能需要登录才能查看评论。

### Q: 分析结果不准确怎么办？
A: 可以调整关键词库和分析参数。

### Q: 如何处理反爬虫限制？
A: 系统已内置延时和请求限制，如遇封禁可适当增加延时间隔。

## 当前问题
目前的监控还不完善，尤其是评论的抓取方面，已经做了如下优化：
1. 放宽CSS选择器，以捕获更广泛的评论元素
2. 优化过滤条件，确保值抓取顶层评论，尽量不遗漏有效评论
3. 增强滚动加载机制与强化等待机制
尽管进行了这些优化，由于微博评论的动态加载特性、页面结构复杂性以及网络环境等因素， 仍不能保证一次性抓取到所有评论 。脚本会尝试尽可能多地抓取，但某些评论可能仍需手动触发加载或在特定条件下才能完全显示

日志记录方面还不完善，尚待开发...主体功能已经完成


## 联系方式

如有问题或建议，请通过以下方式联系：

- 邮箱: 2252334@tongji.edu.cn

---

**注意**: 使用本工具请遵守相关网站的协议和服务条款，仅用于合法的数据分析用途。